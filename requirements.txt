# ---- Core torch stack ----
# Apple Silicon (arm64 macOS) – gets MPS-enabled wheels
torch==2.4.0; platform_system == "Darwin" and platform_machine == "arm64"
torchvision==0.19.0; platform_system == "Darwin" and platform_machine == "arm64"
torchaudio==2.4.0; platform_system == "Darwin" and platform_machine == "arm64"

# Linux/Windows CPU-only fallback
torch==2.4.0+cpu; platform_system != "Darwin" and platform_machine != "arm64" and sys_platform != "linux" and sys_platform != "win32" --extra-index-url https://download.pytorch.org/whl/cpu

# CUDA 12.1 (if available) – these will be ignored on macOS; users with CUDA can `pip install -r requirements-cuda.txt`
torch==2.4.0+cu121; sys_platform == "linux" or sys_platform == "win32" --extra-index-url https://download.pytorch.org/whl/cu121
torchvision==0.19.0+cu121; sys_platform == "linux" or sys_platform == "win32" --extra-index-url https://download.pytorch.org/whl/cu121
torchaudio==2.4.0+cu121; sys_platform == "linux" or sys_platform == "win32" --extra-index-url https://download.pytorch.org/whl/cu121

# ---- Common ML/vision utils ----
einops>=0.7.0
opencv-python>=4.8; platform_system != "Darwin" or platform_machine != "arm64"  # (optional; mac arm64 wheels are heavy)
kornia>=0.7.2